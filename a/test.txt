(entry main ()
  (push 5)
  (push test-output)
  (call)
  (return))

(subr test-cfun ()
  (push make-stream)
  (call)
  (return)
)

;
; test cpmment
;
(subr test-count (x)
  (var tmp)
  (load x)
  (store tmp)
  (push 1)
  (load tmp)
  (sub)
  (store tmp)
  (load tmp)
  (push 0)
  (eq)
  (not)
  (jmpi -8)
  (return))

(subr factorial (n)
  (load n)
  (push 1)
  (eq)
  (not)
  (jmpi 3)
  (push 1)
  (return)
  (push 1)
  (load n)
  (sub)
  (push factorial)
  (call)
  (load n)
  (mul)
  (return)
)

(subr test-output ()
  (push 1)
  (push system-ostream)
  (push stream-output)
  (call)
  (return)
)
